// Generated by CoffeeScript 1.3.3
var HashtagSearch;

HashtagSearch = (function() {

  function HashtagSearch() {
    var hashtag, self, tagManager, url_hashtags, _i, _len, _ref;
    self = this;
    url_hashtags = [];
    _ref = decodeURIComponent(window.location.hash.replace('#', '')).split('|');
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      hashtag = _ref[_i];
      if (hashtag) {
        url_hashtags.push(hashtag);
      }
    }
    root.SockJSClient().send('set_hashtag_filter', url_hashtags);
    tagManager = $('#tag-manager').tagsManager({
      delimeters: [32, 13],
      CapitalizeFirstLetter: false,
      prefilled: url_hashtags,
      tagChangeCallback: function(tagManager, tagList) {
        self.send(tagList);
        tagList = $.map(tagList, encodeURIComponent);
        return location.hash = '#' + tagList.join('|');
      }
    });
  }

  HashtagSearch.prototype.send = function(tagList) {
    root.SockJSClient().send('set_hashtag_filter', tagList);
    return root.SockJSClient().flush_out_queue();
  };

  return HashtagSearch;

})();
